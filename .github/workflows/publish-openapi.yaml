# This job will automatically generates API from Spring Boot controllers
# and publishes to https://github.com/hmcts/cnp-api-docs/blob/master/docs/specs/api-cp-springboot-template.json
# When you run application locally, auto-generated API should be available here http://localhost:4550/v3/api-docs
name: Publish OpenAPI specs
on:
  push:
    branches:
      - "master"

jobs:
  publish-openapi:
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive
      - uses: hmcts/workflow-publish-openapi-spec/.github/workflows/publish-openapi.yml@v1
        secrets:
          SWAGGER_PUBLISHER_API_TOKEN: ${{ secrets.SWAGGER_PUBLISHER_API_TOKEN }}
        with:
          test_to_run: 'uk.gov.hmcts.cp.openapi.OpenAPIPublisherTest'
          java_version: 21
